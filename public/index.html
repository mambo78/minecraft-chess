<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ Mathias Chess v6</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=VT323:wght@400&display=swap" rel="stylesheet">
</head>
<body>
    <div class="game-container">
        <header class="header">
            <h1 class="title">üéÆ Mathias Chess v6 üéÆ</h1>
            <div class="player-info">
                <span class="white-info">White</span>
                <div class="turn-display" id="turn-display">White's Turn</div>
                <span class="black-info">Black</span>
            </div>
        </header>

        <main class="game-section">
            <div class="board-area">
                <div class="coords-left">
                    <div>8</div><div>7</div><div>6</div><div>5</div>
                    <div>4</div><div>3</div><div>2</div><div>1</div>
                </div>
                <div class="board-wrapper">
                    <div class="chess-board" id="chess-board">
                        <!-- Squares generated by JavaScript -->
                    </div>
                    <div class="coords-bottom">
                        <div>a</div><div>b</div><div>c</div><div>d</div>
                        <div>e</div><div>f</div><div>g</div><div>h</div>
                    </div>
                </div>
            </div>

            <!-- Game Controls -->
            <aside class="game-controls">
                <div class="control-section">
                    <h3>üéÆ Game Mode</h3>
                    <div class="mode-buttons">
                        <button id="human-mode-btn" class="btn mode-btn active">üë• vs Human</button>
                        <button id="ai-mode-btn" class="btn mode-btn">ü§ñ vs AI</button>
                    </div>
                </div>

                <div class="control-section">
                    <h3>üé® Themes</h3>
                    <select id="theme-selector" class="select-input">
                        <option value="classic">Classic Chess</option>
                        <option value="minecraft">üéÆ Minecraft</option>
                        <option value="mario">üçÑ Mario Bros</option>
                        <option value="sonic">üí® Sonic</option>
                        <option value="pokemon">‚ö° Pok√©mon</option>
                        <option value="space">üöÄ Space</option>
                        <option value="medieval">‚öîÔ∏è Medieval</option>
                    </select>
                    <button id="random-theme-btn" class="btn">üé≤ Random Theme</button>
                </div>

                <div class="control-section">
                    <h3>Game Controls</h3>
                    <button id="new-game-btn" class="btn">üîÑ New Game</button>
                    <button id="undo-btn" class="btn">‚Ü∂ Undo Move</button>
                </div>
            </aside>
        </main>
    </div>

    <!-- Game Message -->
    <div id="game-message" class="game-message" style="display: none;"></div>

    <!-- Scripts -->
    <script>
        // Simple chess game without external dependencies
        console.log('üöÄ Starting Simple Chess Game...');

        let board = [
            ['r','n','b','q','k','b','n','r'],
            ['p','p','p','p','p','p','p','p'],
            [null,null,null,null,null,null,null,null],
            [null,null,null,null,null,null,null,null],
            [null,null,null,null,null,null,null,null],
            [null,null,null,null,null,null,null,null],
            ['P','P','P','P','P','P','P','P'],
            ['R','N','B','Q','K','B','N','R']
        ];

        let currentPlayer = 'white';
        let selectedSquare = null;
        let gameMode = 'human'; // 'human' or 'ai'
        let aiThinking = false;

        let pieceSymbols = {
            'K': '‚ôî', 'Q': '‚ôï', 'R': '‚ôñ', 'B': '‚ôó', 'N': '‚ôò', 'P': '‚ôô',
            'k': '‚ôö', 'q': '‚ôõ', 'r': '‚ôú', 'b': '‚ôù', 'n': '‚ôû', 'p': '‚ôü'
        };

        function initGame() {
            console.log('‚úÖ Initializing simple chess game...');
            createBoard();
            updateBoard();
            setupControls();
            showMessage('‚úÖ Chess game loaded successfully!', 3000);
        }

        function createBoard() {
            const boardElement = document.getElementById('chess-board');
            boardElement.innerHTML = '';
            
            for (let rank = 8; rank >= 1; rank--) {
                for (let file = 0; file < 8; file++) {
                    const square = document.createElement('div');
                    const isLight = (rank + file) % 2 === 0;
                    
                    square.className = `square ${isLight ? 'light' : 'dark'}`;
                    square.dataset.rank = rank - 1;
                    square.dataset.file = file;
                    square.addEventListener('click', () => handleSquareClick(rank - 1, file));
                    
                    boardElement.appendChild(square);
                }
            }
        }

        function updateBoard() {
            const squares = document.querySelectorAll('.square');
            squares.forEach(square => {
                const rank = parseInt(square.dataset.rank);
                const file = parseInt(square.dataset.file);
                const piece = board[7-rank][file]; // Flip rank for display
                
                square.textContent = piece ? pieceSymbols[piece] || piece : '';
                square.classList.remove('selected');
                
                if (selectedSquare && selectedSquare.rank === rank && selectedSquare.file === file) {
                    square.classList.add('selected');
                }
            });
        }

        function handleSquareClick(rank, file) {
            // Don't allow moves during AI turn
            if (gameMode === 'ai' && currentPlayer === 'black') {
                return;
            }
            
            // Don't allow moves while AI is thinking
            if (aiThinking) {
                return;
            }
            
            const piece = board[7-rank][file];
            
            if (selectedSquare) {
                // Try to move
                if (selectedSquare.rank === rank && selectedSquare.file === file) {
                    // Deselect
                    selectedSquare = null;
                } else {
                    // Make move
                    const moveSuccessful = makeMove(selectedSquare.rank, selectedSquare.file, rank, file);
                    selectedSquare = null;
                    
                    // If in AI mode and move was successful, trigger AI move
                    if (gameMode === 'ai' && moveSuccessful && currentPlayer === 'black') {
                        setTimeout(makeAIMove, 1000);
                    }
                }
            } else {
                // Select piece
                if (piece && isCurrentPlayerPiece(piece)) {
                    selectedSquare = { rank, file };
                }
            }
            
            updateBoard();
            updateTurnDisplay();
        }

        function isCurrentPlayerPiece(piece) {
            if (currentPlayer === 'white') {
                return piece === piece.toUpperCase();
            } else {
                return piece === piece.toLowerCase();
            }
        }

        function makeMove(fromRank, fromFile, toRank, toFile) {
            const piece = board[7-fromRank][fromFile];
            
            // Basic move validation - check if piece exists and belongs to current player
            if (!piece || !isCurrentPlayerPiece(piece)) {
                return false;
            }
            
            // Make the move
            board[7-toRank][toFile] = piece;
            board[7-fromRank][fromFile] = null;
            
            // Switch turns
            currentPlayer = currentPlayer === 'white' ? 'black' : 'white';
            
            const playerName = currentPlayer === 'white' ? 'White' : 'Black';
            if (gameMode === 'ai' && currentPlayer === 'black') {
                showMessage('ü§ñ AI is thinking...', 1500);
            } else {
                showMessage(`${playerName}'s turn`, 1500);
            }
            
            return true;
        }
        
        function getAllPossibleMoves(player) {
            const moves = [];
            
            for (let boardRank = 0; boardRank < 8; boardRank++) {
                for (let file = 0; file < 8; file++) {
                    const piece = board[boardRank][file];
                    if (piece && ((player === 'white' && piece === piece.toUpperCase()) || 
                                 (player === 'black' && piece === piece.toLowerCase()))) {
                        
                        // Generate simple moves (adjacent squares for now)
                        const directions = [
                            [-1, -1], [-1, 0], [-1, 1],
                            [0, -1],           [0, 1],
                            [1, -1], [1, 0], [1, 1]
                        ];
                        
                        for (let [dr, df] of directions) {
                            const newBoardRank = boardRank + dr;
                            const newFile = file + df;
                            
                            if (newBoardRank >= 0 && newBoardRank < 8 && newFile >= 0 && newFile < 8) {
                                const targetPiece = board[newBoardRank][newFile];
                                
                                // Can move to empty square or capture opponent piece
                                const canMove = !targetPiece || 
                                    (player === 'white' && targetPiece === targetPiece.toLowerCase()) ||
                                    (player === 'black' && targetPiece === targetPiece.toUpperCase());
                                    
                                if (canMove) {
                                    // Convert board coordinates to display coordinates
                                    const fromDisplayRank = 7 - boardRank;
                                    const toDisplayRank = 7 - newBoardRank;
                                    
                                    moves.push({
                                        from: { boardRank, file, displayRank: fromDisplayRank },
                                        to: { boardRank: newBoardRank, file: newFile, displayRank: toDisplayRank },
                                        piece: piece,
                                        captured: targetPiece
                                    });
                                }
                            }
                        }
                    }
                }
            }
            
            return moves;
        }
        
        function makeAIMove() {
            if (currentPlayer !== 'black' || gameMode !== 'ai') {
                return;
            }
            
            aiThinking = true;
            updateTurnDisplay();
            
            // Get all possible moves for black
            const possibleMoves = getAllPossibleMoves('black');
            
            console.log('AI found', possibleMoves.length, 'possible moves');
            
            if (possibleMoves.length === 0) {
                aiThinking = false;
                showMessage('üèÅ No moves available!', 3000);
                updateTurnDisplay();
                return;
            }
            
            // Simple AI strategy: prefer captures, then random
            let selectedMoves = possibleMoves.filter(move => move.captured);
            
            if (selectedMoves.length === 0) {
                selectedMoves = possibleMoves;
            }
            
            // Pick a random move from selected moves
            const randomMove = selectedMoves[Math.floor(Math.random() * selectedMoves.length)];
            
            console.log('AI making move:', randomMove);
            
            // Make the move using board coordinates
            board[randomMove.to.boardRank][randomMove.to.file] = randomMove.piece;
            board[randomMove.from.boardRank][randomMove.from.file] = null;
            
            // Switch back to white
            currentPlayer = 'white';
            aiThinking = false;
            
            // Update display
            updateBoard();
            updateTurnDisplay();
            
            if (randomMove.captured) {
                showMessage(`ü§ñ AI captured your ${pieceSymbols[randomMove.captured]}!`, 2500);
            } else {
                showMessage("Your turn!", 2000);
            }
        }

        function updateTurnDisplay() {
            const turnDisplay = document.getElementById('turn-display');
            
            if (aiThinking) {
                turnDisplay.textContent = 'ü§ñ AI Thinking...';
            } else if (gameMode === 'ai') {
                if (currentPlayer === 'white') {
                    turnDisplay.textContent = 'Your Turn';
                } else {
                    turnDisplay.textContent = 'ü§ñ AI Turn';
                }
            } else {
                turnDisplay.textContent = `${currentPlayer === 'white' ? 'White' : 'Black'}'s Turn`;
            }
        }

        // Themes definitions
        const themes = {
            classic: {
                name: '‚ôì Classic Chess',
                pieces: {
                    'K': '‚ôî', 'Q': '‚ôï', 'R': '‚ôñ', 'B': '‚ôó', 'N': '‚ôò', 'P': '‚ôô',
                    'k': '‚ôö', 'q': '‚ôõ', 'r': '‚ôú', 'b': '‚ôù', 'n': '‚ôû', 'p': '‚ôü'
                }
            },
            minecraft: {
                name: 'üéÆ Minecraft',
                pieces: {
                    'K': 'üè∞', 'Q': 'üëë', 'R': 'üè∞', 'B': '‚õ™', 'N': 'üêé', 'P': 'üî¥',
                    'k': 'üè∞', 'q': 'üëë', 'r': 'üè∞', 'b': '‚õ™', 'n': 'üêé', 'p': 'üü¢'
                }
            },
            mario: {
                name: 'üçÑ Mario Bros',
                pieces: {
                    'K': 'üëë', 'Q': 'üë∏', 'R': 'üè∞', 'B': '‚≠ê', 'N': 'üêé', 'P': 'üî¥',
                    'k': 'üëæ', 'q': 'üëë', 'r': 'üèØ', 'b': '‚ö´', 'n': 'üëæ', 'p': 'üîµ'
                }
            },
            sonic: {
                name: 'üí® Sonic',
                pieces: {
                    'K': 'üí®', 'Q': '‚ú®', 'R': 'üüø', 'B': '‚ö°', 'N': 'üèÉ', 'P': 'üîµ',
                    'k': 'ü§ñ', 'q': 'üî•', 'r': 'üóø', 'b': '‚≠ê', 'n': 'üèÉ', 'p': 'üî¥'
                }
            },
            pokemon: {
                name: '‚ö° Pok√©mon',
                pieces: {
                    'K': '‚ö°', 'Q': 'üî•', 'R': 'üíß', 'B': 'üçÉ', 'N': '‚≠ê', 'P': '‚ö™',
                    'k': 'üåô', 'q': 'üåä', 'r': 'üåå', 'b': 'üçÄ', 'n': 'üåü', 'p': '‚ö´'
                }
            },
            space: {
                name: 'üöÄ Space',
                pieces: {
                    'K': 'üöÄ', 'Q': 'üõ∏', 'R': 'üåå', 'B': '‚≠ê', 'N': 'üõ°', 'P': 'üëΩ',
                    'k': 'üõ∏', 'q': 'üåç', 'r': 'üåô', 'b': '‚ú®', 'n': 'üëΩ', 'p': 'üü°'
                }
            },
            medieval: {
                name: '‚öîÔ∏è Medieval',
                pieces: {
                    'K': 'üëë', 'Q': 'üë∏', 'R': 'üè∞', 'B': '‚õ™', 'N': 'üêé', 'P': '‚öî',
                    'k': 'ü§¥', 'q': 'üßù', 'r': 'üèØ', 'b': '‚õ™', 'n': 'üêé', 'p': 'üõ°'
                }
            }
        };

        let currentTheme = 'classic';

        function changeTheme(themeName) {
            if (themes[themeName]) {
                currentTheme = themeName;
                pieceSymbols = themes[themeName].pieces;
                updateBoard();
                showMessage(`Theme changed to ${themes[themeName].name}! üé®`, 2000);
            }
        }

        function setupControls() {
            // New game button
            document.getElementById('new-game-btn').addEventListener('click', () => {
                // Reset board
                board = [
                    ['r','n','b','q','k','b','n','r'],
                    ['p','p','p','p','p','p','p','p'],
                    [null,null,null,null,null,null,null,null],
                    [null,null,null,null,null,null,null,null],
                    [null,null,null,null,null,null,null,null],
                    [null,null,null,null,null,null,null,null],
                    ['P','P','P','P','P','P','P','P'],
                    ['R','N','B','Q','K','B','N','R']
                ];
                currentPlayer = 'white';
                selectedSquare = null;
                updateBoard();
                updateTurnDisplay();
                showMessage('üîÑ New game started!', 2000);
            });

            // Theme selector
            document.getElementById('theme-selector').addEventListener('change', (e) => {
                changeTheme(e.target.value);
            });

            // Random theme button
            document.getElementById('random-theme-btn').addEventListener('click', () => {
                const themeNames = Object.keys(themes);
                const randomTheme = themeNames[Math.floor(Math.random() * themeNames.length)];
                document.getElementById('theme-selector').value = randomTheme;
                changeTheme(randomTheme);
            });

            // Game mode buttons
            document.getElementById('human-mode-btn').addEventListener('click', () => {
                gameMode = 'human';
                aiThinking = false;
                document.getElementById('human-mode-btn').classList.add('active');
                document.getElementById('ai-mode-btn').classList.remove('active');
                showMessage('üë• Human vs Human mode activated!', 2000);
                
                // Reset to white's turn
                currentPlayer = 'white';
                selectedSquare = null;
                updateBoard();
                updateTurnDisplay();
            });
            
            document.getElementById('ai-mode-btn').addEventListener('click', () => {
                gameMode = 'ai';
                aiThinking = false;
                document.getElementById('ai-mode-btn').classList.add('active');
                document.getElementById('human-mode-btn').classList.remove('active');
                showMessage('ü§ñ AI mode activated! You play as White.', 2000);
                
                // Reset to white's turn (player always starts)
                currentPlayer = 'white';
                selectedSquare = null;
                updateBoard();
                updateTurnDisplay();
            });
            
            // Undo button (placeholder)
            document.getElementById('undo-btn').addEventListener('click', () => {
                showMessage('‚öñ Undo feature coming soon!', 2000);
            });
        }

        function showMessage(message, duration = 3000) {
            const messageElement = document.getElementById('game-message');
            messageElement.textContent = message;
            messageElement.style.display = 'block';
            messageElement.style.background = 'rgba(46, 204, 113, 0.9)';
            messageElement.style.color = 'white';
            messageElement.style.padding = '10px 20px';
            messageElement.style.borderRadius = '5px';
            messageElement.style.position = 'fixed';
            messageElement.style.top = '20px';
            messageElement.style.left = '50%';
            messageElement.style.transform = 'translateX(-50%)';
            messageElement.style.zIndex = '1000';
            
            if (duration > 0) {
                setTimeout(() => {
                    messageElement.style.display = 'none';
                }, duration);
            }
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', initGame);
        if (document.readyState !== 'loading') {
            initGame();
        }
    </script>
</body>
</html>